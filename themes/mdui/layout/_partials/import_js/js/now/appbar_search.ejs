<script>
  /* global */
  var appbar = document.querySelector('#blog-appbar');
  var toolbar = document.querySelector('#blog-appbar > .mdui-toolbar');
  var closeBtn = document.querySelector('#close-button');
  var textSpan = document.querySelector('#search-text');
  var textInput = document.querySelector('#search-input');
  var searchCover = document.querySelector('#search-cover');
  var indexMoreBtn = document.querySelector('#index-more');

  /* mobile */
  var drawerBtn = document.querySelector('.drawer-button');
  var siteTitle = document.querySelector('#blog-appbar > .mdui-toolbar > a.mdui-typo-headline');
  var searchBtn = document.querySelector('.search-button');
  var search = document.querySelector('div#search');
  var flexSpacer =  document.querySelector('.flex-spacer.mdui-hidden-sm');

  function openSearch() {
    hide(textSpan);
    hide(indexMoreBtn);
    show(textInput);
    show(closeBtn);
    textInput.focus();
    searchCover.classList.add('active');
    toolbar.classList.add('mdui-shadow-0');
  }

  function mobileSearch() {
    /* mobile */
    hide(drawerBtn);
    hide(siteTitle);
    hide(searchBtn);
    hide(flexSpacer);
    search.classList.remove('mdui-hidden-xs');
    openSearch();
  }

  function closeSearch() {
    /* global */
    show(textSpan)
    show(indexMoreBtn)
    hide(textInput)
    hide(closeBtn)
    searchCover.classList.remove('active');

    var bodyTop = (document.documentElement && document.documentElement.scrollTop) || document.body.scrollTop;
    var pageLocation = document.querySelector('div#top').offsetTop - bodyTop;
    if (pageLocation >= 0) {
      toolbar.classList.remove('mdui-shadow-2');
    }

    /* mobile */
    show(drawerBtn);
    show(siteTitle);
    show(searchBtn);
    show(flexSpacer);
    search.classList.add('mdui-hidden-xs');
  }

  function hide(e) {
    if (e === null) return;
    e.classList.add('mdui-hidden');
  }
  function show(e) {
    if (e === null) return;
    e.classList.remove('mdui-hidden');
  }
</script>
<%- partial('../../../../_widget/js/search/now') %>
